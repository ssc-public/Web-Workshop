# <p align="center">مقدمه‌ای بر آزمون API با استفاده از Postman</p>

<p align="center">
  <img src="Logo.png" alt="Postman Logo" width="400">
</p>



<p align="center"> تحقیق برنامه‌سازی وب - دانشگاه صنعتی شریف</p>
<p align="center"> <strong>ارائه‌دهنده درس:</strong> جناب آقای یحیی پورسلطانی </p>
<p align="center"> <strong>نویسندگان:</strong> آریا تم‌خیشا - درسا ناجی حدادی</p>

---

## <p align="right">پستمن چیست؟</p>

ابزار **Postman** یک راهکار محبوب برای توسعه، تست و مستندسازی APIها است. این ابزار به توسعه‌دهندگان کمک می‌کند تا درخواست‌های مختلف را به API ارسال کرده و پاسخ‌ها را تحلیل کنند. به دلیل **رابط کاربری ساده، امکانات متنوع و پشتیبانی از انواع درخواست‌های HTTP**، این ابزار به یکی از محبوب‌ترین گزینه‌ها برای آزمون API تبدیل شده است.

پستمن امکانات متعددی را برای کار با API فراهم می‌کند، از جمله:
- پشتیبانی از انواع درخواست‌های **HTTP (GET, POST, PUT, DELETE و ...)**
- امکان ارسال **پارامترها، هدرها و توکن‌های احراز هویت**
- قابلیت **مدیریت Collection‌ها** برای دسته‌بندی و اجرای مجموعه‌ای از تست‌های API
- امکان **اجرای اسکریپت‌های تست خودکار** برای بررسی صحت عملکرد API
- ارائه ابزارهای **مستندسازی API** برای همکاری بهتر بین توسعه‌دهندگان

به دلیل این ویژگی‌ها، Postman به یک ابزار استاندارد در صنعت توسعه نرم‌افزار تبدیل شده و در بسیاری از پروژه‌های مدرن برای تست و اعتبارسنجی APIها استفاده می‌شود.

---

## <p align="right">آزمون API چیست؟</p>

فرایند **آزمون API (API Testing)** به این صورت است که درخواست‌هایی به API ارسال شده و پاسخ‌های دریافتی بررسی و تحلیل می‌شوند تا صحت عملکرد API تأیید شود. این آزمون یکی از بخش‌های مهم در توسعه نرم‌افزار محسوب می‌شود زیرا:

- **صحت و عملکرد APIها تضمین می‌شود:** بررسی می‌شود که آیا API در پاسخ به درخواست‌ها **داده‌های صحیح و مورد انتظار را برمی‌گرداند یا خیر**.
- **مشکلات و باگ‌های سیستم‌های متصل به API کاهش پیدا می‌کند:** خطاها و ناسازگاری‌های احتمالی در تعامل بین کلاینت و سرور شناسایی و برطرف می‌شوند.
- **امنیت و قابلیت اطمینان API بررسی می‌شود:** حملات احتمالی (مانند تزریق SQL و حملات XSS) مورد بررسی قرار می‌گیرند و API برای مواجهه با شرایط پیچیده تست می‌شود.
- **بررسی عملکرد API در شرایط مختلف:** تست‌های API بررسی می‌کنند که آیا API **در حجم بالای درخواست‌ها و سناریوهای خاص به‌درستی پاسخ می‌دهد یا خیر**.

**برخلاف تست‌های دستی، آزمون API یک فرایند خودکار و دقیق است که بدون نیاز به تعامل مستقیم با رابط کاربری، بررسی‌های عمیقی را روی عملکرد و پاسخ‌های API انجام می‌دهد.**

---

## <p align="right">چرا آزمون API مهم است؟</p>

برخلاف **آزمون رابط کاربری (UI Testing)** که رفتار یک برنامه را از دید کاربر بررسی می‌کند، آزمون API به‌طور مستقیم با **لایه منطق سیستم و پایگاه داده** ارتباط دارد. این نوع آزمون برای اطمینان از عملکرد صحیح سیستم بسیار حیاتی است و موارد زیر را ارزیابی می‌کند:

**بررسی صحت خروجی API:**  
   آیا API خروجی **مورد انتظار** را تولید می‌کند؟ آیا مقدارهای برگشتی از API **مطابق با داده‌های ارسالی و فرمت مورد انتظار هستند**؟  

**بررسی عملکرد درخواست‌های مختلف:**  
   درخواست‌های **GET, POST, PUT, DELETE** هر کدام وظایف خاصی دارند و باید **تحت شرایط مختلف آزمایش شوند** تا از عملکرد صحیح آن‌ها اطمینان حاصل شود.  

 **تست API در شرایط مختلف:**  
   آیا API **در حجم بالای درخواست‌ها** و شرایط غیرمعمول، مثل **درخواست‌های غیرمنتظره یا داده‌های نادرست**، عملکرد درستی دارد؟  

 **ارزیابی امنیت API:**  
   بررسی می‌شود که آیا API **از حملات رایج مانند تزریق SQL، حملات Cross-Site Scripting (XSS) یا مشکلات احراز هویت محافظت شده است** یا خیر.  

 **تضمین یکپارچگی سیستم‌های متصل به API:**  
   بسیاری از سیستم‌ها وابسته به APIها هستند، بنابراین یک API نادرست ممکن است باعث **خرابی عملکرد کل سیستم** شود. آزمون API تضمین می‌کند که APIها **پایدار و بدون مشکل اجرا می‌شوند**.  

به‌طور کلی، آزمون API **یک گام اساسی در توسعه نرم‌افزارهای مبتنی بر API است که عملکرد، امنیت و قابلیت اطمینان سیستم را تضمین می‌کند**. در ادامه، روش استفاده از **Postman برای انجام آزمون API** را بررسی خواهیم کرد.

---

## <p align="right">آزمون API با Postman</p>

توسعه و تست APIها یکی از مراحل مهم در ساخت نرم‌افزارهای مدرن است. ابزار Postman به توسعه‌دهندگان و تست‌کنندگان این امکان را می‌دهد که **به‌سادگی درخواست‌های مختلفی را به API ارسال کرده و پاسخ‌های آن را بررسی کنند**.  

برای انجام **آزمون API با Postman**، این مراحل کلی طی می‌شود:  

1. **تعریف یک درخواست API** در محیط Postman  
2. **ارسال درخواست به سرور و دریافت پاسخ**  
3. **تحلیل و بررسی پاسخ دریافتی** (JSON یا XML)  
4. **نوشتن تست‌های خودکار برای بررسی صحت عملکرد API**  
5. **مدیریت مجموعه‌ای از درخواست‌های API در قالب Collection**  

در این بخش، با استفاده از **مثال‌های عملی و اسکرین‌شات‌های مربوطه**، نحوه ارسال درخواست‌های مختلف، بررسی پاسخ‌ها، و اجرای تست‌های خودکار را یاد خواهیم گرفت.  


در ادامه، گام‌به‌گام **نحوه اجرای آزمون API در Postman را با یک مثال عملی بررسی خواهیم کرد.**  


---

## <p align="right">مثال عملی: آزمون API در Postman</p>

در این مثال، یک درخواست GET را به یک API عمومی ارسال کرده و پاسخ دریافتی را بررسی می‌کنیم. این یک مثال ساده برای درک نحوه کار Postman در آزمون API است.


##  سناریوی مثال
می‌خواهیم اطلاعات یک پست (Post) را از یک API عمومی دریافت کنیم. برای این کار، از سرویس JSONPlaceholder که یک API آزمایشی رایگان است، استفاده می‌کنیم.

URL درخواست API:
```plaintext
https://jsonplaceholder.typicode.com/posts/1
```
نوع درخواست: 
```plaintext
GET
```
هدف درخواست:  

می‌خواهیم اطلاعات مربوط به Post شماره 1 را از API دریافت کنیم.      

---


## <p align="right">مراحل اجرای تست در Postman</p>


برای اجرای تست، ابتدا Postman را باز کرده و یک درخواست جدید ایجاد می‌کنیم. روی دکمه **New Request** کلیک کرده و از لیست **Method**، گزینه **GET** را انتخاب می‌کنیم. سپس در بخش **Request URL**، آدرس زیر را وارد کرده و روی دکمه **Send** کلیک می‌کنیم تا درخواست اجرا شود.  

```plaintext
https://jsonplaceholder.typicode.com/posts/1
```
![image](https://github.com/user-attachments/assets/8b941d55-f3d8-4eaf-81e8-d3f0f627412b)

پس از ارسال درخواست، یک پاسخ (Response) از سرور دریافت می‌شود که شامل اطلاعات مربوط به Post شماره ۱ است. انتظار داریم که پاسخ به‌صورت JSON بازگردد و شامل داده‌های موردنظر باشد. خروجی مورد انتظار به این شکل خواهد بود:
```plaintext
{
  "userId": 1,
  "id": 1,
  "title": "sunt aut facere repellat provident occaecati excepturi optio reprehenderit",
  "body": "quia et suscipit..."
}
```
![image](https://github.com/user-attachments/assets/55872933-2fca-4ca8-b686-0a1152ae6c21)

حالا برسی میکنیم که کد وضعیت HTTP برابر با 200 OK باشد و فیلد های id و title مقدار داشته و با id درخواست ما برابر باشد که همین گونه است و API ما به درستی پاسخ میدهد.
در ادامه در رابطه با سناریوی تست خودکار صحبت میکنیم.

---

## <p align="right"> مراحل اجرای تست خودکار در Postman</p>
ایجاد درخواست و تنظیم اسکریپت تست
Postman را باز کنید و یک درخواست GET جدید ایجاد کنید.

در قسمت Request URL، آدرس API را وارد کنید:
```plaintext
https://jsonplaceholder.typicode.com/posts/1
```
روی تب Tests کلیک کنید.
کد زیر را برای اجرای تست خودکار وارد کنید:



```plaintext
pm.test("بررسی وضعیت پاسخ", function () {
    pm.response.to.have.status(200);
});

pm.test("بررسی مقدار id", function () {
    var jsonData = pm.response.json();
    pm.expect(jsonData.id).to.eql(1);
});

pm.test("بررسی مقدار userId", function () {
    var jsonData = pm.response.json();
    pm.expect(jsonData.userId).to.eql(1);
});
```
![image](https://github.com/user-attachments/assets/73ab82a3-0e00-4623-a878-c4fce500bb40)

![image](https://github.com/user-attachments/assets/9fdf7558-8ced-415c-b59d-be9d6de515c9)

پس از وارد کردن این کد، روی دکمه Send کلیک می‌کنیم تا درخواست اجرا شود. سپس با مراجعه به تب Test Results می‌توانیم ببینیم که آیا تست‌ها به درستی انجام شده‌اند یا خیر. اگر همه‌چیز درست باشد، خروجی مشابه زیر نمایش داده می‌شود:

![image](https://github.com/user-attachments/assets/428377ab-b414-46b0-8761-1d99dfc7587f)

در این مرحله، اگر تمامی تست‌ها سبز باشند، یعنی API به‌درستی کار می‌کند. اما اگر یکی از تست‌ها رد شود (قرمز شود)، یعنی API مقدار نادرستی بازگردانده است و باید بررسی شود. این روش به توسعه‌دهندگان کمک می‌کند تا از صحت عملکرد API خود اطمینان حاصل کنند و خطاهای احتمالی را سریع‌تر شناسایی کنند.


---

## <p align="right">تست API بیت‌کوین در Postman با قابلیت‌های پیشرفته</p>

در این مثال، قصد داریم نرخ فعلی بیت‌کوین را از یک API عمومی دریافت کنیم، مقدار آن را در متغیر محیطی ذخیره کنیم و سپس از آن در درخواست‌های بعدی استفاده کنیم. همچنین، با استفاده از قابلیت‌های پیشرفته Postman، وضعیت پاسخ، زمان پاسخگویی، ساختار JSON، مقدار داده‌ها و برخی ویژگی‌های دیگر را بررسی خواهیم کرد.
ما یک درخواست GET به API نرخ بیت‌کوین ارسال می‌کنیم و سپس مقدار دریافتی را پردازش می‌کنیم.

یک درخواست GET به URL میزنیم:
```plaintext
https://api.coindesk.com/v1/bpi/currentprice.json
```

![image](https://github.com/user-attachments/assets/099c150c-8836-4a06-afaa-fd6050a06eb0)

پاسخ دریافتی قابل مشاهده است.

در ادامه مانند قبل به بخش Test رفته و در تب Tests کد زیر را وارد کنید:

```plaintext
let jsonData = pm.response.json();
pm.globals.set("bitcoinRate", jsonData.bpi.USD.rate_float);
console.log("Bitcoin Rate:", pm.environment.get("bitcoinRate"));
```
این مقدار اکنون در متغیر گلوبال bitcoinRate ذخیره شده و می‌توان در درخواست‌های بعدی از {{bitcoinRate}} استفاده کرد.

![image](https://github.com/user-attachments/assets/15e669f1-1d5f-4dec-a182-f2ddb78fce9a)

اجرای تست‌های پیشرفته در Postman:

```plaintext
pm.test("وضعیت پاسخ باید 200 باشد", function () {
    pm.response.to.have.status(200);
});
pm.test("زمان پاسخ باید کمتر از 500ms باشد", function () {
    pm.expect(pm.response.responseTime).to.be.below(500);
});
pm.test("پاسخ باید دارای ساختار JSON صحیح باشد", function () {
    pm.expect(pm.response.headers.get("Content-Type")).to.include("application/json");
});
pm.test("نرخ بیت‌کوین باید در داده‌های دریافتی وجود داشته باشد", function () {
    pm.expect(jsonData.bpi.USD).to.be.an("object");
    pm.expect(jsonData.bpi.USD.rate_float).to.be.a("number");
});
pm.test("نرخ بیت‌کوین باید مقدار معتبر داشته باشد", function () {
    let rate = pm.globals.get("bitcoinRate");
    pm.expect(rate).to.be.a("number");
    pm.expect(rate).to.be.above(0);
});
```

این اسکریپت مجموعه‌ای از تست‌های خودکار در Postman است که صحت پاسخ دریافتی از API نرخ بیت‌کوین را بررسی می‌کند. ابتدا، تأیید می‌شود که وضعیت پاسخ HTTP برابر با 200 (موفق) است. بررسی می‌کند که زمان پاسخگویی API کمتر از 500 میلی‌ثانیه باشد تا عملکرد مناسبی داشته باشد. در ادامه،  وجود هدر Content-Type: application/json را تأیید می‌کند تا مطمئن شویم فرمت داده‌های بازگشتی JSON است. بعد از آن، بررسی می‌کند که ساختار JSON شامل اطلاعات مربوط به نرخ بیت‌کوین (bpi.USD.rate_float) باشد و مقدار آن عددی باشد. سپس، مقدار ذخیره‌شده در متغیر گلوبال bitcoinRate را بررسی می‌کند تا مطمئن شویم که یک مقدار عددی معتبر و بزرگ‌تر از صفر دارد.

![image](https://github.com/user-attachments/assets/f7385490-aeb9-4575-879e-e3017e828622)

---

# <p align="right">نتیجه‌گیری</p>

در این مستند، مراحل آزمون API با استفاده از **Postman** را به‌طور جامع بررسی کردیم. ابتدا با **مفهوم API Testing** آشنا شدیم و یاد گرفتیم که چرا این آزمون‌ها برای **اطمینان از صحت عملکرد APIها، کاهش خطاها و افزایش امنیت و قابلیت اطمینان سیستم‌های نرم‌افزاری** ضروری هستند. سپس نحوه **ایجاد و ارسال یک درخواست GET در Postman** را بررسی کردیم و یاد گرفتیم که چگونه **پاسخ دریافتی را تحلیل کنیم و مطمئن شویم که داده‌ها مطابق انتظار بازمی‌گردند**.

در ادامه، با **تست‌های خودکار در Postman** آشنا شدیم و مشاهده کردیم که چگونه می‌توان با استفاده از **اسکریپت‌های JavaScript** در Postman، صحت مقادیر دریافتی از API را بررسی کرد. این امکان به ما کمک می‌کند تا **بدون نیاز به بررسی دستی، آزمون‌های خودکار را اجرا کرده و از صحت داده‌های API اطمینان حاصل کنیم**. همچنین، دیدیم که در صورت بروز خطا در API، چگونه تست‌ها رد شده و می‌توان مشکلات را به‌راحتی شناسایی کرد.

---

# <p align="right">منابع</p>

https://learning.postman.com/docs/designing-and-developing-your-api/testing-an-api/

https://www.postman.com/api-platform/api-testing/

https://qalified.com/blog/postman-for-api-testing/

https://www.geeksforgeeks.org/introduction-postman-api-development/

https://www.postman.com/product/what-is-postman/

https://apidog.com/blog/what-is-postman/

https://www.geeksforgeeks.org/api-testing-software-testing/
