## Dompurify

<p align=center><img  width=1280 src="./assets/Firstpic.webp"  alt="DOMPurify"/></p>

### ๐ููุฑุณุช

- [ููุฏูู](#ููุฏูู)
- [ฺุฑุง ุฌุงูุง ุงุณฺฉุฑูพุชุ](#ฺุฑุง-ุฌุงูุง-ุงุณฺฉุฑูพุชุ)
- [ุฒูุงู ุฑุฎ ุฏุงุฏู XSS](#ุฒูุงู-ุฑุฎ-ุฏุงุฏู-XSS)
- [ุงููุงุน XSS](#ุงููุงุน-XSS)
- [ฺฉุงุฑุจุฑุฏูุง XSS Attack](#ฺฉุงุฑุจุฑุฏูุง-XSS-Attack)
- [ุชุนุฑู Document Object Model](#ุชุนุฑู-Document-Object-Model)
- [ุญูููโ DOM-based XSS](#DOM-based-XSS)
- [ุญูููโ Reflected XSS](#reflected-xss)
- [ููุงุจุน](#ููุงุจุน)

### โ๏ธููุณูุฏฺฏุงู

- [ุขุฑุด ุงุฏฺฏุงุฑ](https://github.com/Arash1381-y)
- [ุงูุงู ูุญูุฏ](https://github.com/Imanm02)
- [ูุณุช ฺฉุฑู](https://github.com/HastiKarimi)

<hr>

## ููุฏูู

ุงฺฏุฑ ุดูุง ฺฉ ุจุฑูุงููโููุณ ุจุงุดุฏุ ุงุญุชูุงู ุฒุงุฏ ุฏุงุฑู ฺฉู ุฏุฑุจุงุฑูโ Cross-site scripting ูุทุงูุจ ุฎูุงูุฏู ุจุงุดุฏ. Cross-site
scripting ฺฉู ูุนูููุงู ุจู ุงุณู XSS ุดูุงุฎุชู ูโุดูุฏุ ุจู ุญููุงุช ฺฏูุชู ูโุดูุฏ ฺฉู ุฏุฑ ุขู ุงุณฺฉุฑูพุชโูุง ูุฎุฑุจุ ุจู ูุจโุณุงุช ูุง ุจุฒุฑฺฏ ู
ูุนุชุจุฑ ุชุฒุฑู ูโุดููุฏ.

ุญููุงุช Cross-site Scripting ุฏุฑ HTMLุ Flashุ ActiveX ู CSS ุงูฺฉุงู ูพุฐุฑ ูุณุชูุฏุ ุจุง ุงู ุญุงู ฺูู ุจุดุชุฑ ฺฉุงุฑุจุฑุงู ุงูุชุฑูุช ุงุฒ ุฌุงูุง
ุงุณฺฉุฑูพุช ุงุณุชูุงุฏู ูโฺฉููุฏุ ุงฺฉุซุฑ ูฺฉุฑูุง ุจุฑ ุฑู ุงู ฺฏุฒูู ุชูุฑฺฉุฒ ุฏุงุฑูุฏ.

ุฏุฑ ุงู ุฑูุด ูุฏู ูฺฉุฑ ุจุดุชุฑ ฺฉุงุฑุจุฑุงู ูุณุชูุฏ ฺฉู ุจู ุณุงุช ูุฑุงุฌุนู ฺฉุฑุฏูโุงูุฏ. ุฏุฑ ูุงูุน ูฺฉุฑูุง ุฏุฑ ุงู ููุน ุญูููุ ุงุทูุงุนุงุช ฺฉุงุฑุจุฑุงู ฺฉ
ุณุงุช ุฑุง ุจุฏูู ุงุทูุงุน ุฎูุฏุดููุ ุจู ุณุฑูุช ูโุจุฑูุฏ.

## ฺุฑุง ุฌุงูุง ุงุณฺฉุฑูพุชุ

ุฌุงูุง ุงุณฺฉุฑูพุช ูุญุจูุจโุชุฑู ุฒุจุงู ุจุฑูุงููโููุณ ุจุฑุง ุทุฑุงุญ ูุจ ุงุณุชุ ุจู ุดูุง ุงู ูุงุจูุชโูุง ุฑุง ูโุฏูุฏ ฺฉู ูุฑ ฺฉุงุฑ ุฏุฑ ุตูุญูโ ูุจ
ุฎูุฏุชูู ุงูุฌุงู ุฏูุฏ ู ูฺฺฏโูุง ูพฺุฏู ุฑุง ุจู ุณุงุฏฺฏ ูพุงุฏูโุณุงุฒ ฺฉูุฏุ

ุฏุฑ ููุงุจู ุจุฑุง ุขุณุจโุฑุณุงู ุจู ุตูุญูโ ูุจ ู ุณุฑูุช ุงุทูุงุนุงุช ฺฉุงุฑุจุฑูุง ูู ุงุฒ ุขู ุงุณุชูุงุฏู ูโุดูุฏ ู ุจุฑุง ูุฑูุฏ ุจู backend ุณุงุช ู ุชุฒุฑู
ุงุณฺฉุฑูพุชโูุง ูุฎุฑุจุ ุฌุงูุง ุงุณฺฉุฑูพุช ูุญุจูุจโุชุฑู ูุฒุจุงู ุญููุงุช Cross-site Scripting ูโุจุงุดุฏ.

## ุฒูุงู ุฑุฎ ุฏุงุฏู XSS

ุญูููโ Cross-site scripting ุง XSS ุฒูุงู ุฑุฎ ูโุฏูุฏ ฺฉู ูฺฉุฑ ุง ฺฉุงุฑุจุฑ ูุฎุฑุจุ ูุจโุณุงุช ุง ูุจโุงูพูฺฉุดู ุฑุง ุจู ุดฺฉู ุฏุณุชฺฉุงุฑ ูโฺฉูุฏ
ุชุง ุฌุงูุง ุงุณฺฉุฑูพุช ูุฎุฑุจ ุจุงุฒฺฏุฑุฏุฏ ุจู ฺฉุงุฑุจุฑ. ุฒูุงู ฺฉู ุงู ฺฉุฏ ุฌุงูุง ุงุณฺฉุฑูพุช ูุฎุฑุจ ุฏุฑ ูุฑูุฑฺฏุฑ ฺฉุงุฑุจุฑ ุงุฌุฑุง ูโุดูุฏุ ุชูุงู ุงุฑุชุจุงุทุงุช
ฺฉุงุฑุจุฑ ุจุง ูุจโุณุงุช ุฏุฑ ูุนุฑุถ ุฎุทุฑ ูุฑุงุฑ ูโฺฏุฑูุฏ ู ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ ุจุฑุง ููุงุฌูุ ูุงุจู ุณุฑูุช ุฎูุงููุฏ ุจูุฏ.

## ุงููุงุน XSS

ุณู ููุน ุงุตู ุงุฒ ุญููุงุช Cross-site Scripting ูุฌูุฏ ุฏุงุฑุฏ:

ฑ. ุญูููโ XSS ุฐุฎุฑู ุดุฏู (Stored cross-site scripting)
ฒ. ุญูููโ XSS ููุนฺฉุณ ุดุฏู (Reflected)
ณ. ุญูููโ XSS ูุจุชู ุจุฑ (DOM (Document Object Model
ุฏุฑ ุงุฏุงูู ูุฑ ฺฉุฏุงู ุงุฒ ุงููุงุน ุญููุงุช XSS ุจุฑุฑุณ ุฎูุงูุฏ ุดุฏ.

## ฺฉุงุฑุจุฑุฏูุง XSS Attack

โข ูุฑ ุนููุงุช ฺฉู ฺฉุงุฑุจุฑุงู ุนุถู ุดุฏู ุฏุฑ ฺฉ ุณุงูุงููุ ุจู ูฺู ฺฉุงุฑุจุฑุงู ุฎุงุต ุจุง ุฏุณุชุฑุณ ุจุงูุง ู premiumุ ูโุชูุงููุฏ ุงูุฌุงู ุฏููุฏ ุฑุง
ุงูุฌุงู ุฏูุฏ.

โข ุจู ูููโ ุฏุงุฏูโูุง ฺฉู ฺฉุงุฑุจุฑ ุนุถู ูโุชูุงูุฏ ุจู ุขูโูุง ุฏุณุชุฑุณ ูพุฏุง ฺฉูุฏุ ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏุ ุขูโูุง ุฑุง ุจุฎูุงูุฏ ุง ุฏุณุชฺฉุงุฑ ฺฉูุฏ

โข ุฎูุฏ ุฑุง ุจู ุฌุง ฺฉุงุฑุจุฑ ุฏฺฏุฑ ุฌุง ุจุฒูุฏ ู ุจู ุญุณุงุจ ฺฉุงุฑุจุฑ ุงู ูููุฐ ฺฉูุฏ.

โข ฺฉ ุจุฏุงูุฒุงุฑ ุจู ูุจโุณุงุช ุชุฒุฑู ฺฉูุฏ ุชุง ูุฑุงุฌุนูโฺฉููุฏฺฏุงู ูุฒ ุขููุฏู ุดููุฏ. ููุงุฌู ูโุชูุงูุฏ ุจู ูุณููโ ุจุฏุงูุฒุงุฑ ุฌุงุณูุณ ฺฉูุฏ ุง
ุงุทูุงุนุงุช ุฑุงุ ุญุช ุจุฏูู ุขฺฏุงู ฺฉุงุฑุจุฑ ูุฑุจุงูุ ุจู ุฏุณุช ุขูุฑุฏ.

โข ุงุทูุงุนุงุช ูุฑูุฏ ุง ูุงฺฏู ฺฉุงุฑุจุฑ ุฑุง ุจุฎูุงูุฏ ู ุฐุฎุฑู ฺฉูุฏ.

โข ูุจโุณุงุช ุฑุง Deface ฺฉูุฏ. (ููุน ุงุฒ ุญููู ุจุฑ ุฑู ูุจโุณุงุช ฺฉู ูฺฺฏโูุง ุธุงูุฑ ุณุงุช ุฑุง ุชุญุช ุชุงุซุฑ ูุฑุงุฑ ูโุฏูุฏ.)

## ุชุนุฑู Document Object Model

ููุงูุทูุฑ ฺฉู ูโุฏุงูุฏุ DOM ุง Document Object Model ูุฏู ุดโฺฏุฑุง ุจุง ุณุงุฎุชุงุฑ ุฏุฑุฎุช ุงุฒ ุงุฌุฒุง ููุฌูุฏ ุฏุฑ ุตูุญู ูโุจุงุดุฏ. DOM
ุชูุฑุจุงุ ุธุงูุฑ ูุงููุฏ ุชุตูุฑ ุฒุฑ ุฏุงุฑุฏ:

<p align=center><img width=800 src="./assets/DOM.jpg"  alt="DOM"/></p>

## DOM-based XSS

ุงู ููุน ุญูููโ XSS ุฒูุงู ุฑุฎ ูโุฏูุฏ ฺฉู ูุฑูุฏ ฺฉุงุฑุจุฑ ุจู ุฑูุด ุฎุทุฑูุงฺฉ ุชูุณุท ุฌุงูุง ุงุณฺฉุฑูพุช ุฏุฑ Document Object Map ุฏุณุชฺฉุงุฑ ุดูุฏ.
ุจุฑุง ูุซุงู ุฒูุงู ูโุชูุงูุฏ ุฑุฎ ุฏูุฏ ฺฉู ููุฏุงุฑ ุงุฒ ฺฉ form ุฎูุงูุฏู ุดูุฏ ู ุฏูุจุงุฑู ุงุฒ ุฌุงูุง ุงุณฺฉุฑูพุช ุงุณุชูุงุฏู ุดูุฏ ุชุง ููุฏุงุฑ ุฏุฑ DOM
ุชุบุฑ ุงุจุฏ.

ุจุฑุง ุงุฑุงุฆูโ ฺฉ ุญููู Dom based XSS ุดูุง ุจุงุฏ ุฏุงุฏู ุฑุง ุฏุฑ ฺฉ ููุจุน ุฐุฎุฑู ฺฉูุฏ ุชุง ุฏุฑ sink ูพุฎุด ู ุจุงุนุซ ุงุฌุฑุง ฺฉุฏ ุฏูุฎูุงู ุดูุฏ.
ุฑุงุฌโุชุฑู ููุจุน ุจุฑุง ุงุฌุฑุง ุญูููโ Dom based XSSุ ฺฉ URL ูโุจุงุดุฏ ฺฉู ูุนูููุง ุจู ุด window.location ุฏุณุชุฑุณ ุฏุงุฑุฏ. ูููุฐฺฏุฑ
ูโุชูุงูุฏ ูพููุฏ ุฑุง ุจุฑุง ูุฑุจุงู ุงุฑุณุงู ููุงุฏ ู ูุฑุจุงู ุฑุง ุจู ฺฉ ุตูุญู ุขุณุจ ูพุฐุฑ ููุฑุงู ฺฉ ูพููุฏ ุฏุฑ query string ูุฏุงุช ฺฉูุฏ.

ููุงุจุน DOM-based XSS ูุนูููุงู ุดุงูู ุชุงุจุน eval() ู ูฺฺฏ innerHTML ูโุจุงุดูุฏ ู ุญูููโูุง ุจู ูุงุณุทูโ ฺฉ URL ุงูุฌุงู ูโุดูุฏ.

<div dir="ltr">

  ```js
const username = document.getElementById('username_input');
const username_box = document.getElementById('username_box');
user_name_box.innerHTML = username;
  ```

</div>

ุจุฑุง ุงุฌุฑุง ุงู ุญูููุ ูโุชูุงูุฏ ุจู input ุงุฌุฑุง ุดุฏูุ ฺฉ ฺฉุฏ ูุฎุฑุจ ุงุถุงูู ฺฉูุฏ:

<div dir="ltr">

  ```js
<script>
    window.alert("Cross site scripting has occurred!");
</script>
  ```

</div>

## Reflected XSS

ุงู ููุน ุงุฒ ุญููุงุช ุฑุงุฌ ุชุฑู ุดฺฉู ุงุฒ ุญููุงุช XSS ูุณุชูุฏ. ุฏุฑ ุงู ุญููุงุช ฺฉ ฺฉุฏ ูุงุจู ุงุฌุฑุง ุฏุฑูู ูุฑูุฑฺฏุฑ ุจู ุนููุงู ฺฉ ูพุงุฑุงูุชุฑ ุฏุฑูู ฺฉ
HTTP request ูุฑุงุฑ ูโฺฏุฑุฏ. ฺฉุฏ ุชุฒุฑู ุดุฏู ุฏุฑูู ุจุฑูุงูู ุฐุฎุฑู ููโุดูุฏ ู ุชููุง ฺฉุงุฑุจุฑุงู ุฑุง ุขููุฏู ูโฺฉูุฏ ฺฉู ุจุฑ ุฑู URL
ุขููุฏูโุดุฏู ฺฉูฺฉ ฺฉุฑุฏูโุงูุฏ. ุจุฑุง ุฏุฑฺฉ ุจูุชุฑ ุจู ูุซุงู ุฒุฑ ุฏูุช ฺฉูุฏ.

ูุฑุถ ฺฉูุฏ ฺฉ ูุจ ุงูพูฺฉุดู ุณุงุฏู ุทุฑุงุญ ฺฉุฑุฏูโุงู ฺฉู ุฏุฑ ุขู ฺฉ ูพุงู ุฎูุดโุขูุฏ ฺฏู ู ุณูพุณ ฺฉ ููฺฉ ุจุฑุง ุฏุฑุงูุช ู ุง ุฏุงูููุฏ ฺฉ
ุจุฑูุงููโ ุงุณุช.

<p align=center><img  width=344 src="./assets/expBase.png"  alt="DOMPurify"/></p>

ููุงูุทูุฑ ฺฉู ูุดุงูุฏู ูโฺฉูุฏ ุฏุฑูู ุฏุฑุฎูุงุณุช ฺฉ ูพุงุฑุงูุชุฑ ุจู ูุงู user ุงุณุชูุงุฏู ุดุฏู ุงุณุช. ุจุงุฏ ุณุน ฺฉูู ุจุฌุง ูุงู ฺฉุงุฑุจุฑ ฺฉ ุงุณฺฉุฑูพุช
ุณุงุฏู ุฑุง ุงุฑุณุงู ฺฉูู.

[//]: # (make code block ltr)
<div dir="ltr">

```html
<!-- Polluted request:-->
https://example.com/index.php?user=
<script> alert(123)</script>
```

</div>

ุงฺฏุฑ ุจุฑูุงูู ุฏุฑ ุจุฑุงุจุฑ ุงู ุญููู ููุงูู ูุจุงุดูุฏุ ุงุทูุงุนุงุช ูุดุงูุฏู ุดุฏู ุฏุฑ ูุฑูุฑฺฏุฑ ุจู ุงู ุตูุฑุช ุฎูุงูุฏ ุจูุฏ:

<img  width=586 src="./assets/expURLparam.png"  alt="DOMPurify"/>

ุงู ุญููุงุช ููฺฉู ุงุณุช ุจุงุนุซ ุงุฌุฑุง ูุงูโูุง ุขููุฏูโุง ุฏุฑ ุฏุณุชฺฏุงู ฺฉุงุฑุจุฑ ูโุดูุฏ.
ูุฑุถ ฺฉูุฏ ฺฉ ุฏุฑุฎูุงุณุช ุขููุฏู ุจู ุงู ุตูุฑุช ูพุงุฏู ฺฉูู:

<div dir="ltr">

```html
  https://example.com/index.php?user=
<script>window.onload = function () {
    const AllLinks = document.getElementsByTagName("a");
    AllLinks[0].href = "https://badexample.com/malicious.exe";
}</script>
```

</div>

ููุงูุทูุฑ ฺฉู ูุดุงูุฏู ูโฺฉูุฏ ุฏุฑ ุตูุฑุช ฺฉู ุจุฑูุงูู ุฏุฑ ุจุฑุงุจุฑ ุงู ุญููู ููุงูู ูุจุงุดุฏุ ุจุฌุง ููฺฉ ุงุตูุ ฺฉ ููฺฉ ุขููุฏู ุจู ฺฉ ูุงู
ุงุฌุฑุง ูุฎุฑุจ ุฌุงฺฏุฒู ูโุดูุฏ.

ุญุงู ฺฉู ฺูุฏ ููููู ุงุฒ ุงู ููุน ุญููุงุช ุฑุง ุฏุฏู ุณูุงู ุงู ูุณุช ฺฉู ฺฺฏููู ูโุชูุงู ุฌูู ุงู ุญููุงุช ุฑุง ฺฏุฑูุช.

#### Preventing reflected XSS

ฺฉ ุงุฒ ุฑุงูโูุง ุฌููฺฏุฑ ุงุฒ ุงู ุญููุงุช ุงุณุชูุงุฏู ุงุฒ ฺฉ ฺฉุชุงุจุฎุงูู ูุซู
DOMPurify ูโุจุงุดุฏ. ุงู ฺฉุชุงุจุฎุงูู ุจู ูุง ุงู ุงูฺฉุงู ุฑุง ูโุฏูุฏ ฺฉู ุงุฒ ุงุณฺฉุฑูพุชโูุง ุฎุทุฑูุงฺฉ ุฏุฑูู ูุชูโูุง ฺฉู ุฏุฑ
DOM ุงุฌุงุฏ ูโุดููุฏ ุฌููฺฏุฑ ฺฉูู. ุจุฑุง ุงุณุชูุงุฏู ุงุฒ ุงู ฺฉุชุงุจุฎุงูู ฺฉุงูุณุช ฺฉู ฺฉุฏ ุฒุฑ ุฑุง ุฏุฑ ุจุฑูุงููโ ุฎูุฏ ูุฑุงุฑ ุฏูุฏ.

<div dir="ltr">

  ```javascript
  var clean = DOMPurify.sanitize(dirty);
   ```

</div>

ุจู ุทูุฑ ูุซุงู ุฏุฑ ุชฺฉู ฺฉุฏ ุฒุฑ URL
ุขููุฏู ูุฑุญูู ูุจู ุฑุง ุจู ฺฉุชุงุจุฎุงูู DOMPurify ูโุฏูู ุชุง ุงุณฺฉุฑูพุชโูุง ุขู ุฑุง ูพุงฺฉ ฺฉูุฏ ู ูุชู ููุง ุฑุง ุจู ูุง ุจุฑฺฏุฑุฏุงูุฏ.
ุชฺฉู ฺฉุฏ ุฒุฑ ููุงุณู URL ูุงุฑุฏ ุดุฏู ู ุฎุฑูุฌ DOMPurify
ูพุณ ุงุฒ ูพุงฺฉุณุงุฒ ุฑุง ูุดุงู ูโุฏูุฏ.

<div dir="ltr">

```js
const dirty = window.location.href;
console.log(dirty);
// first example: https://example.com/index.php?user=
// <script> alert(123)</script>
// second example: https://example.com/index.php?user=
// <script>window.onload = function () {
//     var AllLinks = document.getElementsByTagName("a");
//     AllLinks[0].href = "https://badexample.com/malicious.exe";
// }</script>
const clean = DOMPurify.sanitize(dirty);
console.log(clean);
//first example (clean): https://example.com/index.php?user=
//second example (clean): https://example.com/index.php?user=
```

</div>

## ููุงุจุน

- [GitHub - cure53/H5SC](https://github.com/cure53/H5SC)
- [GitHub - cure53/XSSChallengeWiki](https://github.com/cure53/XSSChallengeWiki/wiki)
- [XSS: What it is, how it works, and how to prevent it](https://medium.com/codelighthouse/xss-what-it-is-how-it-works-and-how-to-prevent-it-454629e3a0da)
