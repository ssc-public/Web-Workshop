## Dompurify

<p align=center><img  width=1280 src="./assets/Firstpic.webp"  alt="DOMPurify"/></p>

### ๐ููุฑุณุช

- [ููุฏูู](#ููุฏูู)
- [ฺุฑุง ุฌุงูุง ุงุณฺฉุฑูพุชุ](#ฺุฑุง-ุฌุงูุง-ุงุณฺฉุฑูพุช)
- [ุฒูุงู ุฑุฎ ุฏุงุฏู XSS](#ุฒูุงู-ุฑุฎ-ุฏุงุฏู-xss)
- [ุงููุงุน XSS](#ุงููุงุน-xss)
- [ฺฉุงุฑุจุฑุฏูุง XSS Attack](#ฺฉุงุฑุจุฑุฏูุง-xss-attack)
- [ุชุนุฑู Document Object Model](#ุชุนุฑู-document-object-model)
- [ุญูููโ DOM-based XSS](#dom-based-xss)
- [ุญูููโ Reflected XSS](#reflected-xss)
- [ุญูููโ Stored XSS](#stored-xss)
- [ุฌููฺฏุฑ ุงุฒ ุญููุงุช XSS](#xss-ุฌููฺฏุฑ-ุงุฒ-ุญููุงุช)
- [ุขูฺู ุงุฏฺฏุฑูุชู](#ุขูฺู-ุงุฏฺฏุฑูุชู)
- [ููุงุจุน](#ููุงุจุน)

### โ๏ธููุณูุฏฺฏุงู

- [ุขุฑุด ุงุฏฺฏุงุฑ](https://github.com/Arash1381-y)
- [ุงูุงู ูุญูุฏ](https://github.com/Imanm02)
- [ูุณุช ฺฉุฑู](https://github.com/HastiKarimi)

<hr>

## ููุฏูู

ุงฺฏุฑ ุดูุง ฺฉ ุจุฑูุงููโููุณ ุจุงุดุฏุ ุงุญุชูุงู ุฒุงุฏ ุฏุงุฑู ฺฉู ุฏุฑุจุงุฑูโ Cross-site scripting ูุทุงูุจ ุฎูุงูุฏู ุจุงุดุฏ. Cross-site
scripting ฺฉู ูุนูููุงู ุจู ุงุณู XSS ุดูุงุฎุชู ูโุดูุฏุ ุจู ุญููุงุช ฺฏูุชู ูโุดูุฏ ฺฉู ุฏุฑ ุขู ุงุณฺฉุฑูพุชโูุง ูุฎุฑุจุ ุจู ูุจโุณุงุช ูุง ุจุฒุฑฺฏ ู
ูุนุชุจุฑ ุชุฒุฑู ูโุดููุฏ.

ุญููุงุช Cross-site Scripting ุฏุฑ HTMLุ Flashุ ActiveX ู CSS ุงูฺฉุงู ูพุฐุฑ ูุณุชูุฏุ ุจุง ุงู ุญุงู ฺูู ุจุดุชุฑ ฺฉุงุฑุจุฑุงู ุงูุชุฑูุช ุงุฒ ุฌุงูุง
ุงุณฺฉุฑูพุช ุงุณุชูุงุฏู ูโฺฉููุฏุ ุงฺฉุซุฑ ูฺฉุฑูุง ุจุฑ ุฑู ุงู ฺฏุฒูู ุชูุฑฺฉุฒ ุฏุงุฑูุฏ.

ุฏุฑ ุงู ุฑูุด ูุฏู ูฺฉุฑ ุจุดุชุฑ ฺฉุงุฑุจุฑุงู ูุณุชูุฏ ฺฉู ุจู ุณุงุช ูุฑุงุฌุนู ฺฉุฑุฏูโุงูุฏ. ุฏุฑ ูุงูุน ูฺฉุฑูุง ุฏุฑ ุงู ููุน ุญูููุ ุงุทูุงุนุงุช ฺฉุงุฑุจุฑุงู ฺฉ
ุณุงุช ุฑุง ุจุฏูู ุงุทูุงุน ุฎูุฏุดููุ ุจู ุณุฑูุช ูโุจุฑูุฏ.

## ฺุฑุง ุฌุงูุง ุงุณฺฉุฑูพุชุ

ุฌุงูุง ุงุณฺฉุฑูพุช ูุญุจูุจโุชุฑู ุฒุจุงู ุจุฑูุงููโููุณ ุจุฑุง ุทุฑุงุญ ูุจ ุงุณุชุ ุจู ุดูุง ุงู ูุงุจูุชโูุง ุฑุง ูโุฏูุฏ ฺฉู ูุฑ ฺฉุงุฑ ุฏุฑ ุตูุญูโ ูุจ
ุฎูุฏุชูู ุงูุฌุงู ุฏูุฏ ู ูฺฺฏโูุง ูพฺุฏู ุฑุง ุจู ุณุงุฏฺฏ ูพุงุฏูโุณุงุฒ ฺฉูุฏุ

ุฏุฑ ููุงุจู ุจุฑุง ุขุณุจโุฑุณุงู ุจู ุตูุญูโ ูุจ ู ุณุฑูุช ุงุทูุงุนุงุช ฺฉุงุฑุจุฑูุง ูู ุงุฒ ุขู ุงุณุชูุงุฏู ูโุดูุฏ ู ุจุฑุง ูุฑูุฏ ุจู backend ุณุงุช ู ุชุฒุฑู
ุงุณฺฉุฑูพุชโูุง ูุฎุฑุจุ ุฌุงูุง ุงุณฺฉุฑูพุช ูุญุจูุจโุชุฑู ูุฒุจุงู ุญููุงุช Cross-site Scripting ูโุจุงุดุฏ.

## ุฒูุงู ุฑุฎ ุฏุงุฏู XSS

ุญูููโ Cross-site scripting ุง XSS ุฒูุงู ุฑุฎ ูโุฏูุฏ ฺฉู ูฺฉุฑ ุง ฺฉุงุฑุจุฑ ูุฎุฑุจุ ูุจโุณุงุช ุง ูุจโุงูพูฺฉุดู ุฑุง ุจู ุดฺฉู ุฏุณุชฺฉุงุฑ ูโฺฉูุฏ
ุชุง ุฌุงูุง ุงุณฺฉุฑูพุช ูุฎุฑุจ ุจุงุฒฺฏุฑุฏุฏ ุจู ฺฉุงุฑุจุฑ. ุฒูุงู ฺฉู ุงู ฺฉุฏ ุฌุงูุง ุงุณฺฉุฑูพุช ูุฎุฑุจ ุฏุฑ ูุฑูุฑฺฏุฑ ฺฉุงุฑุจุฑ ุงุฌุฑุง ูโุดูุฏุ ุชูุงู ุงุฑุชุจุงุทุงุช
ฺฉุงุฑุจุฑ ุจุง ูุจโุณุงุช ุฏุฑ ูุนุฑุถ ุฎุทุฑ ูุฑุงุฑ ูโฺฏุฑูุฏ ู ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ ุจุฑุง ููุงุฌูุ ูุงุจู ุณุฑูุช ุฎูุงููุฏ ุจูุฏ.

## ุงููุงุน XSS

ุณู ููุน ุงุตู ุงุฒ ุญููุงุช Cross-site Scripting ูุฌูุฏ ุฏุงุฑุฏ:

ฑ. ุญูููโ XSS ุฐุฎุฑู ุดุฏู (Stored cross-site scripting)
ฒ. ุญูููโ XSS ููุนฺฉุณ ุดุฏู (Reflected)
ณ. ุญูููโ XSS ูุจุชู ุจุฑ (DOM (Document Object Model
ุฏุฑ ุงุฏุงูู ูุฑ ฺฉุฏุงู ุงุฒ ุงููุงุน ุญููุงุช XSS ุจุฑุฑุณ ุฎูุงูุฏ ุดุฏ.

## ฺฉุงุฑุจุฑุฏูุง XSS Attack

โข ูุฑ ุนููุงุช ฺฉู ฺฉุงุฑุจุฑุงู ุนุถู ุดุฏู ุฏุฑ ฺฉ ุณุงูุงููุ ุจู ูฺู ฺฉุงุฑุจุฑุงู ุฎุงุต ุจุง ุฏุณุชุฑุณ ุจุงูุง ู premiumุ ูโุชูุงููุฏ ุงูุฌุงู ุฏููุฏ ุฑุง
ุงูุฌุงู ุฏูุฏ.

โข ุจู ูููโ ุฏุงุฏูโูุง ฺฉู ฺฉุงุฑุจุฑ ุนุถู ูโุชูุงูุฏ ุจู ุขูโูุง ุฏุณุชุฑุณ ูพุฏุง ฺฉูุฏุ ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏุ ุขูโูุง ุฑุง ุจุฎูุงูุฏ ุง ุฏุณุชฺฉุงุฑ ฺฉูุฏ

โข ุฎูุฏ ุฑุง ุจู ุฌุง ฺฉุงุฑุจุฑ ุฏฺฏุฑ ุฌุง ุจุฒูุฏ ู ุจู ุญุณุงุจ ฺฉุงุฑุจุฑ ุงู ูููุฐ ฺฉูุฏ.

โข ฺฉ ุจุฏุงูุฒุงุฑ ุจู ูุจโุณุงุช ุชุฒุฑู ฺฉูุฏ ุชุง ูุฑุงุฌุนูโฺฉููุฏฺฏุงู ูุฒ ุขููุฏู ุดููุฏ. ููุงุฌู ูโุชูุงูุฏ ุจู ูุณููโ ุจุฏุงูุฒุงุฑ ุฌุงุณูุณ ฺฉูุฏ ุง
ุงุทูุงุนุงุช ุฑุงุ ุญุช ุจุฏูู ุขฺฏุงู ฺฉุงุฑุจุฑ ูุฑุจุงูุ ุจู ุฏุณุช ุขูุฑุฏ.

โข ุงุทูุงุนุงุช ูุฑูุฏ ุง ูุงฺฏู ฺฉุงุฑุจุฑ ุฑุง ุจุฎูุงูุฏ ู ุฐุฎุฑู ฺฉูุฏ.

โข ูุจโุณุงุช ุฑุง Deface ฺฉูุฏ. (ููุน ุงุฒ ุญููู ุจุฑ ุฑู ูุจโุณุงุช ฺฉู ูฺฺฏโูุง ุธุงูุฑ ุณุงุช ุฑุง ุชุญุช ุชุงุซุฑ ูุฑุงุฑ ูโุฏูุฏ.)

## ุชุนุฑู Document Object Model

ููุงูุทูุฑ ฺฉู ูโุฏุงูุฏุ DOM ุง Document Object Model ูุฏู ุดโฺฏุฑุง ุจุง ุณุงุฎุชุงุฑ ุฏุฑุฎุช ุงุฒ ุงุฌุฒุง ููุฌูุฏ ุฏุฑ ุตูุญู ูโุจุงุดุฏ. DOM
ุชูุฑุจุงุ ุธุงูุฑ ูุงููุฏ ุชุตูุฑ ุฒุฑ ุฏุงุฑุฏ:

<p align=center><img width=800 src="./assets/DOM.jpg"  alt="DOM"/></p>

## DOM-based XSS

ุงู ููุน ุญูููโ XSS ุฒูุงู ุฑุฎ ูโุฏูุฏ ฺฉู ูุฑูุฏ ฺฉุงุฑุจุฑ ุจู ุฑูุด ุฎุทุฑูุงฺฉ ุชูุณุท ุฌุงูุง ุงุณฺฉุฑูพุช ุฏุฑ Document Object Map ุฏุณุชฺฉุงุฑ ุดูุฏ.
ุจุฑุง ูุซุงู ุฒูุงู ูโุชูุงูุฏ ุฑุฎ ุฏูุฏ ฺฉู ููุฏุงุฑ ุงุฒ ฺฉ form ุฎูุงูุฏู ุดูุฏ ู ุฏูุจุงุฑู ุงุฒ ุฌุงูุง ุงุณฺฉุฑูพุช ุงุณุชูุงุฏู ุดูุฏ ุชุง ููุฏุงุฑ ุฏุฑ DOM
ุชุบุฑ ุงุจุฏ.

ุจุฑุง ุงุฑุงุฆูโ ฺฉ ุญููู Dom based XSS ุดูุง ุจุงุฏ ุฏุงุฏู ุฑุง ุฏุฑ ฺฉ ููุจุน ุฐุฎุฑู ฺฉูุฏ ุชุง ุฏุฑ sink ูพุฎุด ู ุจุงุนุซ ุงุฌุฑุง ฺฉุฏ ุฏูุฎูุงู ุดูุฏ.
ุฑุงุฌโุชุฑู ููุจุน ุจุฑุง ุงุฌุฑุง ุญูููโ Dom based XSSุ ฺฉ URL ูโุจุงุดุฏ ฺฉู ูุนูููุง ุจู ุด window.location ุฏุณุชุฑุณ ุฏุงุฑุฏ. ูููุฐฺฏุฑ
ูโุชูุงูุฏ ูพููุฏ ุฑุง ุจุฑุง ูุฑุจุงู ุงุฑุณุงู ููุงุฏ ู ูุฑุจุงู ุฑุง ุจู ฺฉ ุตูุญู ุขุณุจ ูพุฐุฑ ููุฑุงู ฺฉ ูพููุฏ ุฏุฑ query string ูุฏุงุช ฺฉูุฏ.

ููุงุจุน DOM-based XSS ูุนูููุงู ุดุงูู ุชุงุจุน eval() ู ูฺฺฏ innerHTML ูโุจุงุดูุฏ ู ุญูููโูุง ุจู ูุงุณุทูโ ฺฉ URL ุงูุฌุงู ูโุดูุฏ.

<div dir="ltr">

  ```js
const username = document.getElementById('username_input');
const username_box = document.getElementById('username_box');
user_name_box.innerHTML = username;
  ```

</div>

ุจุฑุง ุงุฌุฑุง ุงู ุญูููุ ูโุชูุงูุฏ ุจู input ุงุฌุฑุง ุดุฏูุ ฺฉ ฺฉุฏ ูุฎุฑุจ ุงุถุงูู ฺฉูุฏ:

<div dir="ltr">

  ```js
<script>
    window.alert("Cross site scripting has occurred!");
</script>
  ```

</div>

## Reflected XSS

ุงู ููุน ุงุฒ ุญููุงุช ุฑุงุฌ ุชุฑู ุดฺฉู ุงุฒ ุญููุงุช XSS ูุณุชูุฏ. ุฏุฑ ุงู ุญููุงุช ฺฉ ฺฉุฏ ูุงุจู ุงุฌุฑุง ุฏุฑูู ูุฑูุฑฺฏุฑ ุจู ุนููุงู ฺฉ ูพุงุฑุงูุชุฑ ุฏุฑูู ฺฉ
HTTP request ูุฑุงุฑ ูโฺฏุฑุฏ. ฺฉุฏ ุชุฒุฑู ุดุฏู ุฏุฑูู ุจุฑูุงูู ุฐุฎุฑู ููโุดูุฏ ู ุชููุง ฺฉุงุฑุจุฑุงู ุฑุง ุขููุฏู ูโฺฉูุฏ ฺฉู ุจุฑ ุฑู URL
ุขููุฏูโุดุฏู ฺฉูฺฉ ฺฉุฑุฏูโุงูุฏ. ุจุฑุง ุฏุฑฺฉ ุจูุชุฑ ุจู ูุซุงู ุฒุฑ ุฏูุช ฺฉูุฏ.

ูุฑุถ ฺฉูุฏ ฺฉ ูุจ ุงูพูฺฉุดู ุณุงุฏู ุทุฑุงุญ ฺฉุฑุฏูโุงู ฺฉู ุฏุฑ ุขู ฺฉ ูพุงู ุฎูุดโุขูุฏ ฺฏู ู ุณูพุณ ฺฉ ููฺฉ ุจุฑุง ุฏุฑุงูุช ู ุง ุฏุงูููุฏ ฺฉ
ุจุฑูุงููโ ุงุณุช.

<p align=center><img  width=344 src="./assets/expBase.png"  alt="DOMPurify"/></p>

ููุงูุทูุฑ ฺฉู ูุดุงูุฏู ูโฺฉูุฏ ุฏุฑูู ุฏุฑุฎูุงุณุช ฺฉ ูพุงุฑุงูุชุฑ ุจู ูุงู user ุงุณุชูุงุฏู ุดุฏู ุงุณุช. ุจุงุฏ ุณุน ฺฉูู ุจุฌุง ูุงู ฺฉุงุฑุจุฑ ฺฉ ุงุณฺฉุฑูพุช
ุณุงุฏู ุฑุง ุงุฑุณุงู ฺฉูู.

[//]: # (make code block ltr)
<div dir="ltr">

```html
<!-- Polluted request:-->
https://example.com/index.php?user=
<script> alert(123)</script>
```

</div>

ุงฺฏุฑ ุจุฑูุงูู ุฏุฑ ุจุฑุงุจุฑ ุงู ุญููู ููุงูู ูุจุงุดูุฏุ ุงุทูุงุนุงุช ูุดุงูุฏู ุดุฏู ุฏุฑ ูุฑูุฑฺฏุฑ ุจู ุงู ุตูุฑุช ุฎูุงูุฏ ุจูุฏ:

<p align=center><img  width=586 src="./assets/expURLparam.png"  alt="DOMPurify"/></p>

ุงู ุญููุงุช ููฺฉู ุงุณุช ุจุงุนุซ ุงุฌุฑุง ูุงูโูุง ุขููุฏูโุง ุฏุฑ ุฏุณุชฺฏุงู ฺฉุงุฑุจุฑ ุจุดูุฏ.
ูุฑุถ ฺฉูุฏ ฺฉ ุฏุฑุฎูุงุณุช ุขููุฏู ุจู ุงู ุตูุฑุช ูพุงุฏู ฺฉูู:

<div dir="ltr">

```html
  https://example.com/index.php?user=
<script>window.onload = function () {
    const AllLinks = document.getElementsByTagName("a");
    AllLinks[0].href = "https://badexample.com/malicious.exe";
}</script>
```

</div>

ููุงูุทูุฑ ฺฉู ูุดุงูุฏู ูโฺฉูุฏ ุฏุฑ ุตูุฑุช ฺฉู ุจุฑูุงูู ุฏุฑ ุจุฑุงุจุฑ ุงู ุญููู ููุงูู ูุจุงุดุฏุ ุจุฌุง ููฺฉ ุงุตูุ ฺฉ ููฺฉ ุขููุฏู ุจุง ฺฉ ูุงู
ุงุฌุฑุง ูุฎุฑุจ ุฌุงฺฏุฒู ูโุดูุฏ.

## Stored XSS

ุงู ููุน ุญููู ุฒูุงู ุงุชูุงู ูโุงูุชุฏ ฺฉู ุฏุชุงูุง ุชููุฏ ุดุฏู ุชูุณุท ฺฉ ูุฒุฑ ุฏุฑ ุฏุชุงุจุณ ุฐุฎุฑู ุดุฏู ู ุฏุฑ ุฒูุงู ููุฑุฏ ูุงุฒ ุฏุฑ ุตูุญู ููุฏ ูโุดููุฏ.

ูุซุงูโูุง ุจุฑุง ุงู ุดุฑุงุท ูโุชูุงููุฏ ูุฑูโูุง ุง ูพูุงฺฏูโูุง ฺฉู ุจุฑุง ฺฉุงููุช ฺฏุฐุงุฑ ุงุณุชูุงุฏู ูโุดููุฏ ุจุงุดูุฏ. ุงู ููุถูุน ุฒูุงู ุฎุทุฑูุงฺฉ ูโุดูุฏ ฺฉู ุฏุชุง ุชููุฏ ุดุฏู ุชูุณุท ูู ุชูุณุท ฺฉุงุฑุจุฑุงู ุฏฺฏุฑ ุจุชูุงูุฏ ุฏุฏู ุดูุฏ ู ุจู ุนุจุงุฑุช ุชูุณุท ุขูโูุง ูุดุงูุฏู ุดุฏู ู ุฏุฑ ุตูุญูโุงุดุงู ููุฏ ุดูุฏ. ุฏุฑ ุงู ุตูุฑุช ุงุณฺฉุฑูพุช ุชููุฏ ุดุฏู ุชูุณุท ฺฉุงุฑุจุฑ ุงุชฺฉโฺฉููุฏู ุจุฏูู ุฑุถุงุช ฺฉุงุฑุจุฑุงู ุฏฺฏุฑ ุจุฑุงุดุงู ุงุฌุฑุง ุดุฏู ู ูโุชูุงูุฏ ุนูุงูุจ ุจู ููุฑุงู ุฏุงุดุชู ุจุงุดุฏ.

ุจุฑุง ูุซุงู ูุฑุถ ฺฉูุฏ ุฏุฑ ฺฉ ุณุงุช ูุฑ ฺฉุงุฑุจุฑ ูุงุจูุช ุงุฌุงุฏ ุชุฑุฏ ุฏูุฎูุงูุด ุฑุง ุฏุงุดุชู ุจุงุดุฏ ู ุงู ุชุฑุฏูุง ุฏุฑ ุฏุชุงุจุณ ุฐุฎุฑู ุดููุฏ. ุณูพุณ ุฏุฑ ุตูุฑุช ฺฉู ฺฉุงุฑุจุฑ ุฏฺฏุฑ ุจุฎูุงูุฏ ุงุฒ ุขู ุชุฑุฏ ุฏุฏู ฺฉูุฏุ ุงุทูุงุนุงุช ุฐุฎุฑู ุดุฏู ุฏุฑ ุฏุชุงุจุณ ุฏุฑ ุตูุญูโุงุด ููุฏ ูโุดูุฏ ู ุจู ุงู ูุดุงู ุฏุงุฏู ูโุดูุฏ. ฺฉ ฺฉุงุฑุจุฑ ุญูููโฺฉููุฏู ูโุชูุงูุฏ ฺฉุฏูุง ุญุงู ุญูููโ ุฎูุฏ ุฑุง ุจู ุชฺฏ
<div dir="ltr">
  
  ```js
<script></script>
  ```
</div>

ูุฑุงุฑ ุฏูุฏ ู ุงู ฺฉุฏ ุฏุฑ ุจุฑูุฒุฑ ูุฑ ฺฉุงุฑุจุฑ ฺฉู ุขู ุชุฑุฏ ุฑุง ูุดุงูุฏู ูโฺฉูุฏ ุงุฌุฑุง ูโุดูุฏ

### ูุซุงู
<div dir="ltr">
  
  ```js
  <script>
      alert('You are being attacked by Stored XSS');
  </script>
  ```
</div>


## XSS ุฌููฺฏุฑ ุงุฒ ุญููุงุช

ุฏุฑ ูุณูุช ูุจูุ ุจุง ุงููุงุน ุญููุงุช XSS ุขุดูุง ุดุฏู. ููุงูุทูุฑ ฺฉู ูุดุงูุฏู ฺฉุฑุฏุฏุ ูุฑฺฉ ุงุฒ ุงู ุญููุงุช ูโุชูุงููุฏ ฺฉ ุจุณุชุฑ ุฎุงุต ุฑุง ููุฑุฏ ูุฏู ูุฑุงุฑ ุฏููุฏ. 

| Type      	| Origin 	|
|-----------	|--------	|
| Stored    	| Server 	|
| Reflected 	| Server 	|
| DOM-based 	| Client 	|

ฺฉ ุงุฒ ุฑุงูโูุง ุฌููฺฏุฑ ุงุฒ ุงู ููุน ุญููุงุช ุงุณุชูุงุฏู ุงุฒ ฺฉุชุงุจุฎุงููโูุง ูุณุชูุฏ ฺฉู ูโุชูุงููุฏ ุฏุฑุฎูุงุณุชโูุง ุขููุฏู ุง ูุญุชูุงุช ูุงูโูุง HTMLโุง ฺฉู ุขููุฏู ุดุฏูโุงูุฏ ุฑุง ูพุงฺฉุณุงุฒ ฺฉููุฏ. DOM Purify ฺฉ ุงุฒ ูุญุจูุจโุชุฑู ฺฉุชุงุจุฎุงููโโูุง ููุฑุฏ ุงุณุชูุงุฏู ุจุฑุง ุดูุงุณุง ู ุฑูุน ุขููุฏฺฏโูุง ุงุณุช ุชุง ุงุฒ ุญููุงุช ุงุญุชูุงู ุฌููฺฏุฑ ฺฉูุฏ.

 ## DOM purify
ููุงูุทูุฑ ฺฉู ุงุฒ ูุงู ุขู ูุดุฎุต ุงุณุชุ ุงู ฺฉุชุงุจุฎุงูู ูโุชูุงูุฏ ุจุง ุจุฑุฑุณ  ูุฏู ุฏุฑุฎุชุ ูุณูุชโูุง ุขููุฏู ุฑุง ุดูุงุณุง ู ุงุตูุงุญ ฺฉูุฏ. ุฏุฑ ุงุฏุงูู ฺูุฏ ูุซุงู ุงุฒ ูุญูู ุนููฺฉุฑุฏ  DOM purify ุฑุง ูุดุงูุฏู ูโฺฉูุฏ.

```javascript
import DOMPurify from 'dompurify';
DOMPurify.sanitize('<img src=x onerror=alert(1)//>'); // becomes <img src="x">
DOMPurify.sanitize('<svg><g/onload=alert(2)//<p>'); // becomes <svg><g></g></svg>
DOMPurify.sanitize('<p>abc<iframe//src=jAva&Tab;script:alert(3)>def</p>'); // becomes <p>abc</p>
DOMPurify.sanitize('<math><mi//xlink:href="data:x,<script>alert(4)</script>">'); // becomes <math><mi></mi></math>
DOMPurify.sanitize('<TABLE><tr><td>HELLO</tr></TABL>'); // becomes <table><tbody><tr><td>HELLO</td></tr></tbody></table>
DOMPurify.sanitize('<UL><li><A HREF=//google.com>click</UL>'); // becomes <ul><li><a href="//google.com">click</a></li></ul>
```

<div dir="rtl">
URLโูุง ฺฉ ุงุฒ ูุญุจูุจโ ุชุฑู ุงูุฏุงู ุจุฑุง ุงููุงุน ุญููุงุช ูุณุชูุฏ. ุฏุฑ ุญููุงุช reflected XSS ู DOM-based XSS ูููููโูุง ุงุฒ ุฏุณุชฺฉุงุฑ URL ุฑุง ุฏุฏู.
ุจู ฺฉูฺฉ DOM purify ูโุชูุงูู ุงุฒ ุขููุฏู ูุจูุฏู URL ุงุทููุงู ุญุงุตู ฺฉูู.


</div>

```javascript
import DOMPurify from 'dompurify';
let windowUrl = window.location.href;
let cleanUrl = DOMPurify.sanitize(windowUrl);
```

ุจุง ุงูฺฉู DOM purify ุฏุฑ ุณูุช Client ูโุชูุงูุฏ ุงุฒ ุญููุงุช DOM-based XSS ุฌููฺฏุฑ ฺฉูุฏ ุงูุง ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุฏฺฏุฑ ุญููุงุช ูุงุฒ ุงุณุช ุชุง ุจุชูุงูู ุฏุฑ ุณูุช ุณุฑูุฑ ูุฒ ูพุงฺฉุณุงุฒโูุง ูุงุฒู ุฑุง ุงูุฌุงู ุฏูู. 

ุจู ุฏูู ุขูฺฉู ุฏุฑ ุณูุช ุณุฑูุฑ ุจู DOM ุฏุณุชุฑุณ ูุฏุงุฑู ูุงุฒู ุงุณุช ุชุง ฺฉ DOM ุฑุง ุฏุฑ ุณูุช ุณุฑูุฑ ุจุณุงุฒู. ฺฉ ุงุฒ ุฑุงูโูุง ุณุงุฎุชูุ ุงุณุชูุงุฏู ุงุฒ ฺฉุชุงุจุฎุงูู jsdom ุงุณุช. ุจุง ฺฉูฺฉ ุงู ฺฉุชุงุจุฎุงูู ูโุชูุงูู ุขุจุฌฺฉุชโูุง ุขููุฏู ุฑุง ุฏุฑ ุณูุช ุณุฑูุฑ ูุฒ ุดูุงุณุง ฺฉูู ุชุง ุงุฒ ุจุฑูุฒ ุญููุงุช ูุงููุฏ reflected XSSโูุง ู stored XSSโูุง ุฌููฺฏุฑ ฺฉูู.

```javascript
import { JSDOM } from 'jsdom';
import DOMPurify from 'dompurify';

const window = new JSDOM('').window;
const purify = DOMPurify(window);
const clean = purify.sanitize('<b>hello there</b>');
```

## ุขูฺู ุงุฏฺฏุฑูุชู
ุฏุฑ ุงู ูุทูุจ ุณุน ุดุฏ ุชุง ุงููุงุน ุญููุงุช XSS ุดูู ุจฺฉุงุฑฺฏุฑ ุขููุง ู ููฺูู ุฑุงโูโูุง ุฌููฺฏุฑ ุงุฒ ุขู ุฏุฑ ุจุฑูุงููโูุงูุงู ุฑุง ูุนุฑู ฺฉูู. 
ุฏุฏู ฺฉู ุจุฑุง ูพุงฺฉุณุงุฒ ู ุฌููฺฏุฑ ุงุฒ ุงุฌุฑุง ุดุฏู ฺฉุฏโูุง ุขููุฏู ุชูุณุท ฺฉุงุฑุจุฑุงู ูโุชูุงูู ุงุฒ ฺฉุชุงุจุฎุงููโูุง ูุงููุฏ DOM purify ุงุณุชูุงุฏู ฺฉูู ู ูููฺูู
ุดููโูุง ุจู ฺฉุงุฑฺฏุฑ ุขู ุฏุฑ ุณูุช client ู server ุฑุง ุฏุฏู.

## ููุงุจุน

- [GitHub - cure53/H5SC](https://github.com/cure53/H5SC)
- [GitHub - cure53/XSSChallengeWiki](https://github.com/cure53/XSSChallengeWiki/wiki)
- [XSS: What it is, how it works, and how to prevent it](https://medium.com/codelighthouse/xss-what-it-is-how-it-works-and-how-to-prevent-it-454629e3a0da)
- [XSS: Cross-site scripting](https://security.snyk.io/vuln/SNYK-JS-DOMPURIFY-2863266)
- [Type of XSS](https://owasp.org/www-community/Types_of_Cross-Site_Scripting)
- [Testing for Reflected XSS](https://github.com/OWASP/wstg/blob/master/document/4-Web_Application_Security_Testing/07-Input_Validation_Testing/01-Testing_for_Reflected_Cross_Site_Scripting.md)

</div>
